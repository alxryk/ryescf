"use strict";(self.webpackChunkfindagrave_frontend=self.webpackChunkfindagrave_frontend||[]).push([[7493],{7493:(e,o,t)=>{var a=t(3336),i=t.n(a),r=t(6141),d=t(8169),n=t(4203),s=t(4430),l=(t(7009),t(3336)),c=function(e,o,t,a){return new(t||(t=Promise))((function(i,r){function d(e){try{s(a.next(e))}catch(e){r(e)}}function n(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var o;e.done?i(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(d,n)}s((a=a.apply(e,o||[])).next())}))},m=function(e,o){var t,a,i,r,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function n(r){return function(n){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;d;)try{if(t=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return d.label++,{value:r[1],done:!1};case 5:d.label++,a=r[1],r=[0];continue;case 7:r=d.ops.pop(),d.trys.pop();continue;default:if(!(i=d.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){d=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){d.label=r[1];break}if(6===r[0]&&d.label<i[1]){d.label=i[1],i=r;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(r);break}i[2]&&d.ops.pop(),d.trys.pop();continue}r=o.call(e,d)}catch(e){r=[6,e],a=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,n])}}},h=function(e,o){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var a,i,r=t.call(e),d=[];try{for(;(void 0===o||o-- >0)&&!(a=r.next()).done;)d.push(a.value)}catch(e){i={error:e}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(i)throw i.error}}return d};const u=function(){function e(){this.supportsHistory=history&&history.replaceState,this.initialized=!1}return e.prototype.initializeClickHandler=function(){var e=this;i()(document).on("click",".board-item---img, .collage-item, #main-photo",(function(){return c(this,void 0,void 0,(function(){var o,t;return m(this,(function(a){switch(a.label){case 0:return o=parseInt(i()(this).attr("data-photo-id")),!e.initialized?[4,e.initializeMain(o)]:[3,2];case 1:a.sent(),a.label=2;case 2:return t=i()(".viewer-item").index(i()(".viewCurrentImg-"+o)),e.owl.trigger("to.owl.carousel",[t]),[2]}}))}))}))},e.prototype.initializeMain=function(e){return c(this,void 0,void 0,(function(){var o,a;return m(this,(function(r){switch(r.label){case 0:return o=this,this.initialized=!0,[4,Promise.all([t.e(6368).then(t.bind(t,8805)),Promise.resolve().then(t.t.bind(t,7009,23))])];case 1:return a=h.apply(void 0,[r.sent(),1]),a[0].default(l,window,document),this.owl=i()(".photo-viewer-carousel"),this.owl.on("initialized.owl.carousel",(function(t){if(o.owl.on("changed.owl.carousel",(function(e){var t=i()(".viewer-item").eq(e.item.index),a=t.attr("data-myphoto"),r=t.attr("data-photo-id");o.userIsOwner(a,r),i()(".currentItemCount").html(e.item.index+1)})),e){var a=i()(".viewer-item").eq(t.item.index).attr("data-myphoto");i()(".currentItemCount").html(t.item.index+1),o.userIsOwner(a,e),e=null}})),this.owl.owlCarousel({lazyLoad:!1,items:1,smartSpeed:300,mouseDrag:!1,touchDrag:!0,nav:!0,navText:["<span class='icon-arrowleft' aria-hidden='true'></span><span class='visually-hidden'>Previous</span>","<span class='icon-arrowright' aria-hidden='true'></span><span class='visually-hidden'>Next</span>"],URLhistoryHashListener:!0,startPosition:"URLHash"}),[2]}}))}))},e.prototype.destroy=function(){this.owl.trigger("destroy.owl.carousel"),this.initialized=!1},e.prototype.addPhoto=function(e){this.owl.trigger("add.owl.carousel",[e])},e.prototype.userIsOwner=function(e,o){findagrave.contributorId&&(i()(".showrotatel").attr("data-id",o).removeClass("hidden"),i()(".showrotater").attr("data-id",o).removeClass("hidden")),"Yes"==e?(i()(".showDelete").removeClass("hidden"),i()(".showDelete").attr("data-id",o),i()(".showSave").attr({"data-id":o,disabled:!0}),i()(".showSave").addClass("disabled"),i()(".showSave").removeClass("hidden"),i()(".showCancel").removeClass("hidden"),i()("#photo-viewer-footer").removeClass("hidden")):(i()(".showDelete").addClass("hidden"),i()(".showSave").addClass("hidden"),i()(".showCancel").addClass("hidden"),i()(".showDelete").removeAttr("data-id"),i()(".showSave").removeAttr("data-id"),i()("#photo-viewer-footer").addClass("hidden"))},e}();var p=t(5609),f=t(9268),v=t(8282),g=t(5339),w=t(3336);var b=t(3336);var C=t(5104),y=t(1230),I=t(3539),k=(t(7090),t(1658)),x=t(3336);function P(e){"string"==typeof e?x(e).addClass("in").removeClass("hidden").attr("role","alert"):e.addClass("in").removeClass("hidden").attr("role","alert")}var S,F,T=function(e,o){return Object.defineProperty?Object.defineProperty(e,"raw",{value:o}):e.raw=o,e},L=(0,I.W)({name:"findagrave-frontend-memorial"}),R=t(3638),A=t(5561),q=t(7720),j=t(7270),O=t(4956),D=t(5852),U=t(2934),M=t(9916),_=t(7451),E=t(3486),V=t(6435),z=t(4320),B=t(8398),N=new u;function H(e,o){return(0,C.default)(e,o,{html:!0})}function G(e,o,a,r,d,n,s,l,c){var m={};i().when(i().ajax({url:"/memorial/photos",data:{memorialId:e,ajax:!0,skip:n,limit:d}}),i().ajax({url:"/memorial/"+e+"/photo-request-eligibility",data:{ajax:!0}})).done((function(d,n){var h=d[0];h.photoRequest=n[0],h.memorialSummary={memorialId:findagrave.memorialId,nameForURL:findagrave.nameForURL},function(e,o){var t=0;e.result.photos.forEach((function(e){e.contributorId==o&&t++})),e.myPhotoCount=t}(h,a),"overview"===findagrave.tabId&&l&&findagrave.weRememberURL&&function(e){e&&(findagrave.weRememberURL+="&img="+e);i()("#weRememberWidget").find("iframe").attr("src",findagrave.weRememberURL)}(h.result.weRememberPhoto),findagrave.memorialCemeteryId&&0!=findagrave.memorialCemeteryId||(h.photoRequest.isPhotoRequestAllowed=!1,h.photoRequest.message="UnknownBurial"),h.isAddPhotoAllowed=findagrave.isAddPhotoAllowed&&"UserAccountSuspended"!==h.photoRequest.message,h.isAddPhotoAllowed||(h.photoRequest.isPhotoRequestAllowed=!1),h.result.count>=(findagrave.sponsorContributorId?h.result.maxPhotosForSponsoredMemorial:h.result.maxPhotosPerMemorial)?(h.isAddPhotoAllowed=!1,h.isAddPhotoAllowedMessage="MemorialMaxReached",h.photoRequest.message="MaxPhotosReached"):h.myPhotoCount>=(findagrave.sponsorContributorId===a?h.result.maxPhotosForSponsor:h.result.maxPhotosPerUser)?(h.isAddPhotoAllowed=!1,h.isAddPhotoAllowedMessage="UserMaxReached"):S&&(S.options.maxFiles=findagrave.photosRemaining=(findagrave.sponsorContributorId===a?h.result.maxPhotosForSponsor:h.result.maxPhotosPerUser)-h.myPhotoCount,S.options.uploadCount=0),m.photosSkip=h.loadmore.next,m.photosLimit=h.limit,h.contributorId=a,h.memorialId=e,h.memorialContributorId=o,h.isFamous=r,h.removeAds=findagrave.removeAds,h.sendFlowersURL=findagrave.sendFlowersURL;var u=R.render(h);if(s)i()(".floating-board").before(A.render(h)),i()(".board-item").each((function(e){i()(this).data("initial-index",e)})),i()("#myPhotos").is(":checked")?findagrave.divPhotos=i()(".photos-list .board-item").not(".css--my-photo, .floating-board").detach():(i()(".photos-board-item").show(),findagrave.divPhotos&&(i()(findagrave.divPhotos).appendTo(".photos-list").each((function(){var e=i()(this).data("initial-index");i()(".board-item").eq(e).before(this)})),findagrave.divPhotos=null)),i()(".photo-viewer-carousel").append(u),i()("#loadmoreajaxloaderPhotos").hide();else{i()(".photosCount").html(h.result.count);var p=q.render(h),f=j.render(h);if(i()("#sortModalPlaceHolder").html(f),h&&h.result&&h.result.photos&&h.result.photos.length>1){var v=document.getElementById("photo-sort-list");t.e(1474).then(t.bind(t,1474)).then((function(e){new(0,e.default)(v,{draggable:"li.photo-sort",ghostClass:"sortable-placeholder",chosenClass:"sortable-chosen",dragClass:"sortable-drag",fallbackOnBody:!0})}))}h.result.photos.forEach((function(e,o){e.photoId===findagrave.coverPhotoId&&(h.result.photos.splice(o,1),h.removed=!0)}));var g=O.render(h);i()(".js--photoGrid").html(g),i()('[data-bs-toggle="popover"]').popover(),i()("#TabPhotos").html(p),0!==h.myPhotoCount&&h.myPhotoCount!=h.result.count||i()("#photoFilterOptions").addClass("hidden"),i()(".board-item").each((function(e){i()(this).data("initial-index",e)})),"myPhotos"==findagrave.photoSelectedTab?(findagrave.divPhotos=i()(".photos-list .board-item").not(".css--my-photo, .floating-board").detach(),i()("#allPhotos").removeAttr("checked"),i()("#myPhotos").prop("checked","checked"),i()(".css--my-photo").length<8?i()(".photos-list .floating-board").hide():i()(".photos-list .floating-board").show(),findagrave.photoSelectedTab="myPhotos"):(i()(".photos-board-item").show(),findagrave.divPhotos&&(i()(findagrave.divPhotos).appendTo(".photos-list").each((function(){var e=i()(this).data("initial-index");i()(".board-item").eq(e).before(this)})),findagrave.divPhotos=null),i()(".photos-board-item").length<8?i()(".photos-list .floating-board").hide():i()(".photos-list .floating-board").show(),findagrave.photoSelectedTab="allPhotos"),i()(".photo-viewer-carousel").html(u),setTimeout(W,2e3)}var w=/view-photo=(\d+)/;if(-1!==location.hash.indexOf("view-photo")){var b=0;w.test(location.hash)&&(b=parseInt(w.exec(location.hash)[1])),N.initializeClickHandler(),N.initializeMain(b),i()("#photoViewer").modal("show")}else N.initializeClickHandler();i()('[data-bs-target="#photoViewer"]').attr("data-bs-toggle","modal"),c(m)}))}function W(){i()(".photogrid-wrapper").height()-i()(".section-bio-cover").height()-i()(".nav-memorial").height()>parseInt(i()(".section-bio-brief").css("min-height"),10)&&i()(".section-bio-brief").css("min-height",i()(".photogrid-wrapper").height()-i()(".section-bio-cover").height()-i()(".nav-memorial").height())}function Y(e,o,t,a,r,d){if("Y"===findagrave.stillLiving){var n={memorialSummary:{stillLiving:"Y"},flowerPage:!0},s=D.render(n);i()("#TabFlowers").html(s)}else if("Y"===findagrave.flowerCheck){n={memorialSummary:{noMoreFlowers:"Y"},flowerPage:!0},s=D.render(n);i()("#TabFlowers").html(s)}else{var l={};i().ajax({url:"/memorial/flowers",data:{memorialId:e,contributorId:findagrave.contributorId,ajax:!0,skip:a,limit:18},success:function(e){if(function(e,o){var t=0;e.result.flowers.forEach((function(e){e.contributorId==o&&t++})),e.myFlowerCount=t}(e,o),l.flowersSkip=e.loadmore.next,l.flowersLimit=e.limit,r){var t=U.render(e);i()("#flower-list").append(t),i()(".board-item").each((function(e){i()(this).data("initial-index",e)})),i()("#myFlowers").is(":checked")?findagrave.divFlowers=i()(".flowers-board-list .board-item").not(".css--my-flower, .floating-board").detach():(i()(".flower-board-item").show(),findagrave.divFlowers&&(i()(findagrave.divFlowers).appendTo(".flowers-board-list").each((function(){var e=i()(this).data("initial-index");i()(".board-item").eq(e).before(this)})),findagrave.divFlowers=null)),i()("#loadmoreajaxloader").hide()}else{e.contributorId=o,e.removeAds=findagrave.removeAds,e.userLocation=findagrave.userLocation,e.plantTreesScenario=findagrave.plantTreesScenario,e.cemeteryId=findagrave.memorialCemeteryId,e.cemeteryCountryId=findagrave.cemeteryCountryId,i()(".flowersCount").html((s=e.result.count)>=1e4?5*Math.floor(s/5e3)+"k+":s>=1e3?Math.floor(s/1e3)+"k+":s),e.result.contributorId=e.contributorId,e.result.memorialSummary={removeAds:e.removeAds,memorialId:findagrave.memorialId,nameForURL:findagrave.nameForURL},e.result.userLocation=e.userLocation,e.removeAds=findagrave.removeAds,e.sendFlowersURL=findagrave.sendFlowersURL;var a=M.render(e.result);i()("#flowersGrid").html(a);var n=_.render(e);i()("#TabFlowers").html(n),0!==e.myFlowerCount&&e.myFlowerCount!=e.result.count||i()("#flowerFilterOptions").addClass("hidden"),i()(".board-item").each((function(e){i()(this).data("initial-index",e)})),"myFlowers"==findagrave.flowerCheckedOption&&(i()("#myFlowers").prop("checked",!0),findagrave.divFlowers=i()(".flowers-board-list .board-item").not(".css--my-flower, .floating-board").detach()),i()("#myFlowers").is(":checked")?(findagrave.divFlowers=i()(".flowers-board-list .board-item").not(".css--my-flower, .floating-board").detach(),i()(".css--my-flower").length<8?i()(".flowers-board-list .floating-board").hide():i()(".flowers-board-list .floating-board").show()):i()(".flower-board-item").show()}var s;i()('[data-bs-toggle="popover"]').popover(),d(l)}})}}function Z(){i()(".flower-ajax-loader, #add-leave-flower").addClass("hidden"),i()(".flower-note").addClass("hidden"),i()(".choose-flower, #category-select").removeClass("hidden")}function Q(e,o){Z(),i().ajax({url:"/category/flowers",data:{selectedgrouping:e,contributorId:o},success:function(e){var o=E.render(e);i()("#flower-carousel").html(o),i()("#flower-category-select").val(e.selectedgrouping),e.selectedgrouping.indexOf("custom")>-1?i()(".scrapbook-content-more").removeClass("hidden"):i()(".scrapbook-content-more").addClass("hidden")}})}function J(e,o){var t=i()("#noteForVolunteers"),a=i()("#includeEmailInMessage"),r=a.parents(".request-wrapper-inner"),d=i()("#btnSubmitPhotoRequest"),n=i()("#noteForVolunteers"),s=i()("#btnCancelPhotoRequest"),l=i()("#btnClosePhotoRequest"),c=i()("#msgRequestSuccess"),m=i()("#msgRequestFailed"),h=i()("#requestPhoto");n.on("focus",(function(){i()("#noteForVolunteers").closest(".mb-3").removeClass("has-error")})),d.on("click",(function(){i()("#note-required").addClass("hidden");var o=a.is(":checked")?"Y":"N",n=t.val();if("Y"==findagrave.intermentHasPhoto&&!n)return i()("#noteForVolunteers").closest(".mb-3").addClass("has-error"),i()("#note-required").removeClass("hidden"),!1;d.attr("disabled","disabled"),findagrave.photosSkip=0,findagrave.photosLimit=20,i().ajax({url:"/memorial/"+e+"/photo-request",data:{includeEmail:o,note:n},method:"POST",success:function(o){i()("#TabPhotos").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),i()(".js--photoGrid").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),i()("#requestPhoto").modal("hide"),window.scrollTo(0,0),P(c),setTimeout((function(){c.addClass("out")}),5e3),G(e,findagrave.memorialContributorId,findagrave.contributorId,findagrave.isFamous,null,null,!1,!1,(function(e){findagrave.photosLimit=e.photosLimit,findagrave.photosSkip=e.photosSkip}))},error:function(e){d.addClass("hidden"),s.addClass("hidden"),l.removeClass("hidden"),r.addClass("hidden"),m.removeClass("hidden")}})})),h.on("show.bs.modal",(function(){var e;e=findagrave.memorialCemeteryId,L.query({query:(0,y.Ps)(F||(F=T(["query($ids: [ID!]!) { cemeteryVolunteers(ids: $ids) { total } }"],["query($ids: [ID!]!) { cemeteryVolunteers(ids: $ids) { total } }"]))),variables:{ids:[e]}}).then((function(e){var o,t,a=null===(t=null===(o=e.data)||void 0===o?void 0:o.cemeteryVolunteers[0])||void 0===t?void 0:t.total;a>0?i()("#contributorCountInfo").html(i18next.t("mem.ovr.requestAPhotoVolunteersForCemetery",{count:a,nf:a})):i()("#contributorCountInfo").html(i18next.t("mem.ovr.requestAPhotoNoVolunteersForCemetery"))})),r.removeClass("hidden"),d.prop("disabled",!1),d.removeClass("hidden"),s.prop("disabled",!1),s.removeClass("hidden"),l.addClass("hidden"),t.removeClass("hidden"),a.removeClass("hidden"),i()("label, input[id=includeEmailInMessage]:checkbox").removeClass("hidden"),i()("label, textarea[id=noteForVolunteers]").removeClass("hidden"),m.addClass("hidden"),t.val(""),a.prop("checked",!1)}))}q.env.addFilter("truncateHtml",H),A.env.addFilter("truncateHtml",H),i()((function(){var e=new r.Z;new n.Z,new f.Z,new s.Z(e.recaptcha),(0,p.Z)(),""!==findagrave.tabId&&("overview"===findagrave.tabId?(i()("#TabOverview").addClass("in"),i()("#TabOverview").addClass("active"),i()("#memorial-all-memorial").attr("aria-current","true"),i()("a[tabid=TabOverview]").parent().addClass("active"),i()("#memorial-all-memorial").addClass("active"),findagrave.selectedTab="memorial"):"photo"===findagrave.tabId?(i()("#TabPhotos").addClass("in"),i()("#TabPhotos").addClass("active"),i()(".section-transfer").addClass("nom"),i()("#memorial-all-photos").attr("aria-current","true"),i()("a[tabid=TabPhotos]").parent().addClass("active"),i()("#memorial-all-photos").addClass("active"),findagrave.selectedTab="photos"):"flower"===findagrave.tabId&&(i()("#TabFlowers").addClass("in"),i()("#TabFlowers").addClass("active"),i()("#memorial-all-flowers").attr("aria-current","true"),i()("a[tabid=TabFlowers]").parent().addClass("active"),i()("#memorial-all-flowers").addClass("active"),i()(".section-transfer").addClass("nom"),findagrave.selectedTab="flowers")),function(){var e=b("#rapGeneralProblem"),o="";function t(o,t,a){var i=o.find(".prob-number");i.html(i.html().replace("#index#",a)),o.find(".prob-general-reason").html(e.find('[value="'+t.generalReason+'"]').text()),o.find(".prob-detailed-reason").html(t.detailedReason);var r=document.createElement("a"),d=document.createTextNode(t.publicName);r.appendChild(d),r.target="_blank",r.href=t.contributorLink,o.find(".prob-reported-by-link").html(r),o.find(".prob-reported-by-date").text(t.dateCreatedFormatted),t.contributorId==findagrave.contributorId?o.find(".prob-reported-delete").removeClass("hidden").attr("data-id",t.photoRequestProblemId):o.find(".prob-reported-delete").remove()}function a(t){var a=e.val(),i=b("#rapDetailedReason").val();b.ajax({url:"/photo-request/"+o+"/report-problem",data:{generalReason:a,detailedReason:i,doDelete:t,ajax:!0},method:"POST",success:function(){window.location.reload()},error:function(){window.location.reload()}})}b(document).on("click",".btn-modal-List-problems",(function(e){var o=b(e.currentTarget).data("photorequestid");b.ajax({url:"/photo-request/"+o+"/problems",data:{ajax:!0},success:function(e){for(var o=b("#modal-List-problems").find(".modal-body"),a=o.find(".prob-template"),i=e.result.photoRequestProblems,r=0;r<i.length;r++){var d=a.clone();d.removeClass("hidden"),t(d,i[r],r+1),o.append(d)}}})})),b(document).on("click",".prob-reported-delete",(function(e){b(e.currentTarget).closest(".prob-template").find(".delete-problem-error").addClass("hidden");var o=b(e.currentTarget).data("id");b.ajax({url:"/photo-request/"+o+"/delete-problem",method:"DELETE",success:function(o){"success"==o.status?window.location.reload():b(e.currentTarget).closest(".prob-template").find(".delete-problem-error").removeClass("hidden")},error:function(o){b(e.currentTarget).closest(".prob-template").find(".delete-problem-error").removeClass("hidden")}})})),b(document).on("hide.bs.modal","#modal-List-problems",(function(){b(this).find(".modal-body").find(".prob-template").not(".hidden").remove()})),b(document).on("click",".show-reportProblemModal",(function(e){o=b(e.currentTarget).data("photorequestid")})),b("#btn-submit-reportProblem").on("click",(function(){b("#problem-error-div").parent().removeClass("has-error"),b("#problem-error-div").hasClass("hidden")||b("#problem-error-div").addClass("hidden"),e.val().trim()?(b(this).attr("disabled"),a("no")):(b("#problem-error-div").parent().addClass("has-error"),b("#problem-error-div").removeClass("hidden"))})),b("#btn-submit-reportProblem-delete").on("click",(function(){b("#problem-error-div").parent().removeClass("has-error"),b("#problem-error-div").hasClass("hidden")||b("#problem-error-div").addClass("hidden"),e.val().trim()?(b(this).attr("disabled"),a("yes")):(b("#problem-error-div").parent().addClass("has-error"),b("#problem-error-div").removeClass("hidden"))}))}(),i()(document).on("GAv4Loaded",(function(){if(findagrave.ancestryHintWidgetTemplate){var e=findagrave.ancestryHintWidgetTemplate.toLowerCase();"ancestry"!==e&&"combined"!==e||(e="legacy_"+e),gtag("event","view_ancestry_hints_widget",{app_name:"Find a Grave",template:e})}"Y"!=findagrave.removeAds&&findagrave.sendFlowersURL&&gtag("event","view_send_flowers_button",{app_name:"Find a Grave",view:findagrave.tabId})})),i()("#family-grid").on("click","div.member-item",(function(e){window.location.href=e.currentTarget.dataset.href})),i()(".ancestry-hint-widget-item").on("click",(function(){if(findagrave.ancestryHintWidgetTemplate){var e=findagrave.ancestryHintWidgetTemplate.toLowerCase();"ancestry"!==e&&"combined"!==e||(e="legacy_"+e),gtag("event","click_ancestry_hints_widget",{app_name:"Find a Grave",template:e})}})),i()(document).on("click",".send-flowers-button",(function(){gtag("event","click_send_flowers_button",{app_name:"Find a Grave",view:findagrave.tabId})})),findagrave.isAddPhotoAllowed&&t.e(2025).then(t.t.bind(t,2025,23)).then((function(e){var o=e.default;!HTMLCollection.prototype[Symbol.iterator]&&(HTMLCollection.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator]),!NodeList.prototype[Symbol.iterator]&&(NodeList.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator]),!FileList.prototype[Symbol.iterator]&&(FileList.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator]),o.autoDiscover=!1,i()("#dragImg").dropzone({paramName:"file",acceptedFiles:"image/png,image/jpeg,image/gif,image/webp,image/png,.heic,.heif,image/heif,image/heic",previewsContainer:"#drag-preview-list",previewTemplate:document.querySelector("#preview-template").innerHTML,createImageThumbnails:!1,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,uploadMultiple:!1,parallelUploads:1,timeout:48e4,maxFileSize:20,maxFiles:findagrave.photosRemaining||5,dictFileTooBig:i()("#i18n-sizeExceeded").text(),dictInvalidFileType:i()("#i18n-notAPhoto").text(),dictMaxFilesExceeded:i()("#i18n-maxFilesExceeded").text(),url:function(e){return e[0].uploadUrl},params:function(e){var o={key:e[0].key,"Content-Type":e[0].type.trim()||"image/"+e[0].name.substring(e[0].name.lastIndexOf(".")+1).toLowerCase(),acl:"private"};for(var t in e[0].AWSFields)o[t]=e[0].AWSFields[t];return o},uploadCount:0,accept:function(e,o){var t=this;if(this.options.uploadCount>=this.options.maxFiles)return o(this.options.dictMaxFilesExceeded);this.options.uploadCount++;var a=e.type.replace("image/","")||e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase();i().getJSON("/memorial/".concat(findagrave.memorialId,"/photo-url/").concat(a,"?approvalStatus=").concat(findagrave.approvalStatus,"&isFamous=").concat(findagrave.isFamous,"&removeAds=").concat(findagrave.removeAds)).always((function(a,i,r){200===a.responseCode?(e.uploadUrl=a.url,e.key=a.key,e.AWSFields=a.fields,e.success_action_redirect=a.success_action_redirect,o()):t.uploadError(e,a.responseJSON,-1)}))},init:function(){var e=this;S=this;var t=!0,a=i()("#addPhotoSubmit"),r=i()("#CancelUpload"),d=i()("#closeAddPhotoOverlay"),n=i()("#FinishedUpload"),s=i()(".dragdrop-wrapper"),l=i()("#number-of-images"),c=i()("#upload-error"),m=i()("#upload-success");e.on("addedfile",(function(e){i()(e.previewTemplate).find(".uploaded-item--status").text(i()("#i18n-waiting").text())})),e.on("processing",(function(o){e.displayDoneButton(),e.displayUploadingCount()})),e.on("removedfile",(function(t){var a=e.getActiveFiles().length,r=e.getFilesWithStatus(o.SUCCESS).length,d="";a>=0?1===a?d=i()("#i18n-uploadingPhoto").text().replace("1",""+a):a>1&&(d=i()("#i18n-uploadingPhotos").text().replace("2",""+a)):1===r?d=i()("#i18n-photoUploaded").text().replace("1",""+r):r>1&&(d=i()("#i18n-photosUploaded").text().replace("2",""+r)),e.displayDoneButton(),l.text(d)})),a.on("click",(function(o){e.getAcceptedFiles().length>0&&(a.addClass("hidden"),r.addClass("hidden"),n.removeClass("hidden"),n.attr("disabled","disabled"),s.slideUp(),e.processQueue())})),d.on("click",(function(){e.removeAllFiles(!0),n.addClass("hidden"),a.removeClass("hidden"),r.removeClass("hidden"),s.fadeIn(),c.addClass("hidden"),m.addClass("hidden"),l.text(""),i()("#TabPhotos").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),i()(".js--photoGrid").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),findagrave.photosSkip=0,findagrave.photosLimit=20,G(findagrave.memorialId,findagrave.memorialContributorId,findagrave.contributorId,findagrave.isFamous,null,null,!1,!1,(function(e){findagrave.photosLimit=e.photosLimit,findagrave.photosSkip=e.photosSkip}))})),r.on("click",(function(){e.removeAllFiles(!0),i()("#add-photos").modal("hide"),l.text("")})),e.on("sending",(function(e,o,t){var a=i()(e.previewTemplate);a.find(".uploaded-item--status").html(i()("#progressBar").clone().html()),a.find("[data-dz-remove]").addClass("invisible")})),e.displayUploadingCount=function(){var o="",t=e.getAcceptedFiles().length;1===t?o=i()("#i18n-uploadingPhoto").text().replace("1",""+t):t>1&&(o=i()("#i18n-uploadingPhotos").text().replace("2",""+t)),l.text(o)},e.displayDoneButton=function(){0===e.getActiveFiles().length?n.removeClass("hidden"):n.addClass("hidden")},e.uploadError=function(o,a,r){o.accepted&&e.options.uploadCount--,t=!1;var d=i()(o.previewTemplate);d.find("[data-dz-remove]").removeClass("invisible");var n=d.find(".uploaded-item--status");n.addClass("text-danger icon-warning"),d.find("[data-dz-remove]").addClass("invisible"),a&&"Invalid File Type"===a.description?n.text(i()("#i18n-invalidType").text()):r?a&&"memorial"===a.type?n.text(i()("#i18n-failed-memorial").text()):a&&"contributor"===a.type?n.text(i()("#i18n-failed-contributor").text()):a&&"sponsoredMemorial"===a.type?n.text(i()("#i18n-failed-sponsored-memorial").text()):a&&"sponsor"===a.type?n.text(i()("#i18n-failed-sponsor").text()):n.text(i()("#i18n-failed").text()):n.text(a),r&&-1!==r&&e.processQueue(),e.displayUploadingCount()},e.on("error",e.uploadError),e.on("success",(function(o,t,a){var r={photo:o.key,fulfill:!1};!findagrave.fulfill||findagrave.claimedBy&&findagrave.claimedBy!=findagrave.contributorId||(r.fulfill=!0),i().ajax({method:"POST",url:o.success_action_redirect,data:r}).done((function(t,r,d){t.result.autoPhotoRequestFulfilled&&i()("#photoRequestFulfilled").removeClass("hidden"),i()(o.previewTemplate).find("[data-dz-remove]").removeClass("invisible");var n=i()(o.previewTemplate).find(".uploaded-item--status");e.emit("thumbnail",o,t.result.images.thumbnail.path);var s=i()("#progressBar").clone(),l=i()("#photoTypeOptions").clone();l.find("[type=radio]").attr("name","photoType-"+t.result.photoId).parent().attr("data-id",t.result.photoId),l.find("textarea").attr("name","publicNote-"+t.result.photoId),s.find(".progress-bar").css("width","100%").attr("aria-valuenow",100).addClass("bg-success"),s.append(l.html()),n.html(s.html()),n.find("textarea").val(""),s.find(".progress-bar").css("width","0%").attr("aria-valuenow",0).removeClass("bg-success"),s.find(".viewer-item---pictype").remove(),s.find("textarea").remove(),s.find(".captionSaved").remove(),l.find("[type=radio]").removeAttr("name"),l.find("textarea").removeAttr("name"),i()(o.previewTemplate).find("[data-dz-remove]").on("click",(function(){i().ajax({method:"POST",url:"/memorial/delete-photo",data:{ajax:!0,photoId:t.result.photoId,memorialId:findagrave.memorialId},success:function(o){e.options.uploadCount--}})}));var c=i()(o.previewTemplate).find("textarea");c.on("blur",(function(){i().ajax({method:"POST",url:"/memorial/update-photo",data:{ajax:!0,photoId:t.result.photoId,memorialId:findagrave.memorialId,publicNote:c.val()},success:function(e){i()(o.previewTemplate).find("span.captionSaved").removeClass("hidden");setTimeout((function(){i()(o.previewTemplate).find("span.captionSaved").addClass("hidden")}),2e4)}})})),e.displayDoneButton(),a&&e.processQueue()})).fail((function(t,i,r){e.uploadError(o,t.responseJSON,a),e.displayDoneButton()}))})),e.on("uploadprogress",(function(e,o,t){o-=10;var a=i()(e.previewTemplate).find(".uploaded-item--status"),r=i()("#progressBar").clone();r.find(".progress-bar").css("width",o+"%").attr("aria-valuenow",o),a.html(r.html())})),e.on("queuecomplete",(function(){t?(i()("#upload-error").addClass("hidden"),i()("#upload-success").removeClass("hidden")):(i()("#upload-error").removeClass("hidden"),i()("#upload-success").addClass("hidden")),t=!0,n.prop("disabled",!1);var a="",r=e.getFilesWithStatus(o.SUCCESS).length;a=0===r?"":1===r?i()("#i18n-photoUploaded").text().replace("1",r.toString()):i()("#i18n-photosUploaded").text().replace("2",""+r.toString()),l.text(a)})),n.on("click",(function(){e.removeAllFiles(),n.addClass("hidden"),a.removeClass("hidden"),r.removeClass("hidden"),i()("#upload-error").addClass("hidden"),i()("#upload-success").addClass("hidden"),i()("#add-photos").modal("hide"),s.fadeIn(),i()("#TabPhotos").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),i()(".js--photoGrid").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),findagrave.photosSkip=0,findagrave.photosLimit=20,G(findagrave.memorialId,findagrave.memorialContributorId,findagrave.contributorId,findagrave.isFamous,null,null,!1,!1,(function(e){findagrave.photosLimit=e.photosLimit,findagrave.photosSkip=e.photosSkip}))}))}})})),i()(document).on("show.bs.tab",'a[data-bs-toggle="tab"], button[data-bs-toggle="tab"]',(function(e){var o=i()(e.target).attr("href");"#TabPhotos"===o||"#TabFlowers"===o?(i()(".js--photoGrid").addClass("hidden"),i()(".bio-dp").removeClass("main-img"),i()("#mem-mrc-sidespot2").addClass("hidden").next(".ad-text").addClass("hidden"),i()("#famous-sky-side").addClass("hidden").next(".ad-text").addClass("hidden")):(i()(".js--photoGrid").removeClass("hidden"),i()(".bio-dp").addClass("main-img"),i()("#mem-mrc-sidespot2").removeClass("hidden").next(".ad-text").removeClass("hidden"),i()("#famous-sky-side").removeClass("hidden").next(".ad-text").removeClass("hidden"))})),i()(".profileImage").on("load error",(function(){if("overview"==findagrave.tabId&&i()(".small").length&&i()(".nav-memorial").length){if(i()(".small").offset().top+i()(".small").height()<i()(".nav-memorial").offset().top)i()(".bio-dp").find(".small").addClass("over-text");else if(i()(".small").offset().top>i()(".nav-memorial").offset().top);else{var e=i()(".nav-memorial").offset().top-i()(".small").offset().top;e<i()(".small").height()&&i()(".small").css({"margin-top":e+"px"})}i()(".bio-dp").find(".small").removeClass("invisible")}})).each((function(){this.complete&&i()(this).trigger("load")}));var o=new Date,a=o.getDate();a<9&&(a="0"+a),i()("#dateHolder").text(a+" "+findagrave.Month[o.getMonth()]+" "+o.getFullYear()),i()("body").on("click",(function(){i()("#flowerReportSuccess").addClass("hidden"),i()("#flowerReportFailed").addClass("hidden")})),i()(document).on("keyup",".captionText",(function(){var e,o;e=i()(this),o=i()(e).attr("name").split("-")[1],i()(".showSave[data-id="+o+"]").prop("disabled",!1),i()(".showSave[data-id="+o+"]").removeClass("disabled")})),i()(document).on("click","input[name='setProfilePhoto']",(function(){var e,o,t;e=this,o=findagrave.memorialId,t=1,e.checked&&(t=0),i().ajax({method:"POST",url:"/memorial/set-profile-photo",data:{photoId:e.value,memorialId:o,sortOrder:t},success:function(o){if(200===o.status){if(i()("#coverChanged-"+e.value).show().siblings().hide(),setTimeout((function(){i()("#coverChanged-"+e.value).hide().siblings().show()}),3e3),e.checked){i()("#profileImagePlaceholder").remove(),i()("#main-photo").remove();var t=i()(".setImage-".concat(e.value)).clone();t.attr("src",t.attr("src").replace(".com/photos/",".com/photos250/photos/")),i()("figure.bio-dp").prepend(i()('<a href="#" role="button" class="photo-'.concat(e.value,'" id="main-photo" data-bs-target="#photoViewer" data-photo-id="').concat(e.value,'" data-toggle="modal"></a><')).append(t)),i()("figure.bio-dp").find("p a[href^='/user/profile']").replaceWith(i()(".viewCurrentImg-".concat(e.value)).find("a[href^='/user/profile']").clone()),findagrave.coverPhotoId=Number(e.value)}else i()(".profileImage").attr("src","/assets/images/img-grave.jpg");findagrave.isPhotoOverlayUpdated=!0}}})})),i()(document).on("click",".each-flower-image",(function(){i()(".flower-note, #add-leave-flower").removeClass("hidden"),i()(".choose-flower, #category-select").addClass("hidden"),i()("#chosen-flower").html(i()(this).parent().html())}));var l=i()("#name-filter");function c(){findagrave.isAddPhotoAllowed&&(findagrave.fulfill=!0,i()("#photoRequestPresent").addClass("hidden"),i()(".dragdrop-wrapper").removeClass("hidden"),i()("#addTitle").addClass("hidden"),i()("#fulfillTitle").removeClass("hidden"),i()("#add-photos").modal("show"))}function m(e){i()("#photoViewer").modal("hide")}function h(e,o){i()("#editImageLoader-"+e).show(),i()(".showrotatel").attr("disabled","disabled"),i()(".showrotater").attr("disabled","disabled"),i().ajax({url:"/photo/rotate",type:"PUT",data:{angle:o,photoId:e,memorialId:findagrave.memorialId},success:function(o){if(o&&o.dateModified){i()(".setImage-"+e).attr("src",i()(".setImage-"+e).attr("src")+"?v="+o.dateModified);var t=i()('img[data-imgphoto-id="'.concat(e,'"]')).attr("src")||i()('img[data-imgphoto-id="'.concat(e,'"]')).data("src");i()('img[data-imgphoto-id="'.concat(e,'"]')).attr("src",t+"?v=".concat(o.dateModified))}i()(".showrotatel").prop("disabled",!1),i()(".showrotater").prop("disabled",!1),i()("#editImageLoader-"+e).hide()},error:function(o){i()(".showrotatel").prop("disabled",!1),i()(".showrotater").prop("disabled",!1),i()("#editImageLoader-"+e).hide(),alert("fail")}})}function u(e,o){var t=i()(e).hasClass("next")?"next":"previous",a=Number(i()(e).attr("data-tutorial-step"));i()(".dot-container").not(".tutorials .dot-container").remove();var r=i()(".tutorials .dot-wrapper");if(i()(".tutorials").removeClass("hidden"),2===a)i()("#bio-name").after(r.html()),C(i()("#bio-name"));else if(3===a){if(!o&&"previous"===t)return i()(e).attr("disabled","disabled"),void(window.location.href=i()("#memorial-all-memorial").attr("href")+"#tutorial-memorial-photo");i()("#memorial-all-photos").prepend(r.html()),i()(".data-photos").prepend(r.html()),C(i()("#memorial-all-photos"))}else if(4===a){if(!o)return i()(e).attr("disabled","disabled"),void(window.location.href=i()("#memorial-all-photos").attr("href")+"#tutorial-photo");i()("html,body").animate({scrollTop:i()("#memorial-all-photos").offset().top-100},200)}else if(5===a){if(!o)return i()(e).attr("disabled","disabled"),void(window.location.href=i()("#memorial-all-flowers").attr("href")+"#tutorial-flower");i()("html,body").animate({scrollTop:i()("#memorial-all-flowers").offset().top-100},200)}else if(6===a){if(!o&&"next"===t)return i()(e).attr("disabled","disabled"),void(window.location.href=i()("#memorial-all-memorial").attr("href")+"#tutorial-memorial");i()(".data-family").prepend(r.html()),C(i()(".data-family"))}else 7===a?(i()(".see-more").append(r.html()),C(i()(".see-more"))):8===a?(i()(".fg-spn-link").prepend(r.html()),C(i()(".fg-spn-link"))):9===a?(i()(".share").prepend(r.html()),C(i()(".share"))):10===a?(i()(".saveTo").prepend(r.html()),C(i()(".saveTo"))):11===a&&(i()(".edit").prepend(r.html()),C(i()(".edit")));i()(".tutorials div.text-center").addClass("hidden"),i()(".panel-mem-"+a).removeClass("hidden")}function C(e){e.each((function(e){if(i()(this).is(":visible")){var o=i()(this).offset().top,t=i()(window).scrollTop(),a=t+window.innerHeight-i()(".tutorials").height()-i()("#header-main").height()-i()(".top-msg").height();return!(o<t||o>a)||(i()("html,body").animate({scrollTop:o-window.innerHeight/3},200),!1)}}))}k.Observable.fromEvent(l,"keydown").debounce(300).subscribe((function(e){var o=l.val().trim();if(""!==o){i()("#name-filter-close").removeClass("hidden");var t=new RegExp(o,"i");i()("#flower-carousel .flower-each-title").each((function(e){var o=i()(this);t.test(o.text())?o.parents(".flower-cell").show():o.parents(".flower-cell").hide()}))}else i()("#flower-carousel .flower-cell").show(),i()("#name-filter-close").addClass("hidden")})),i()("#name-filter-close").on("click",(function(){l.val(""),i()("#flower-carousel .flower-cell").show(),i()("#name-filter-close").addClass("hidden")})),i()("#choose-different").on("click",(function(){Z()})),i()(".loadingImg").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),i()("#memorial-all-photos").on("click",(function(){findagrave.selectedTab="photos"})),i()("#memorial-all-flowers").on("click",(function(){findagrave.selectedTab="flowers"})),i()("#memorial-all-memorial").on("click",(function(){findagrave.selectedTab="memorial"})),setTimeout((function(){Y(findagrave.memorialId,findagrave.contributorId,findagrave.flowersLimit,findagrave.flowersSkip,!1,(function(e){findagrave.flowersLimit=e.flowersLimit,findagrave.flowersSkip=e.flowersSkip}))}),10),i()(".fameVote").on("click",(function(){var e,o,t,a;e=findagrave.personId,o=findagrave.memorialId,t=i()(this).val(),a=findagrave.minFameVotesNeeded,i().ajax({method:"POST",url:"/memorial/famelevel-voting",data:{personId:e,fameLevel:t,memorialId:o},success:function(e){i()("#voted").removeClass("hidden").addClass("in"),i()("#voted").show(),i()("#voted").delay(15e3).fadeOut("slow"),e.record.fameRakingVotes>=a?(i()(".fameRankingVotes").html(e.record.fameRakingVotes),i()(".fameRanking").html(e.record.fameRanking)):i()(".fameRankingVotes").html(e.record.fameRakingVotes)}})})),i()(window).on("scroll",(function(){"photos"==findagrave.selectedTab&&(i()(window).scrollTop()+i()(window).height()+5>=i()(document).height()||(0,g.Z)(i()("div#morePhotos > div.photos-board-item:nth-last-child(5)")))&&findagrave.photosSkip&&"none"===i()("#loadmoreajaxloaderPhotos").css("display")&&(i()("#loadmoreajaxloaderPhotos").show(),G(findagrave.memorialId,findagrave.memorialContributorId,findagrave.contributorId,findagrave.isFamous,findagrave.photosLimit,findagrave.photosSkip,!0,!1,(function(e){findagrave.photosLimit=e.photosLimit,findagrave.photosSkip=e.photosSkip}))),"flowers"==findagrave.selectedTab&&(i()(window).scrollTop()+i()(window).height()+5>=i()(document).height()||(0,g.Z)(i()("div#flower-list > div.flower-board-item:nth-last-child(5)")))&&findagrave.flowersSkip&&"none"===i()("#loadmoreajaxloader").css("display")&&(i()("#loadmoreajaxloader").show(),Y(findagrave.memorialId,findagrave.contributorId,findagrave.flowersLimit,findagrave.flowersSkip,!0,(function(e){findagrave.flowersLimit=e.flowersLimit,findagrave.flowersSkip=e.flowersSkip})))})),i()("#add-flower-note").on("keyup",(function(){i()(this).val(i()(this).val().replace(/\r?\n/gi,""));var e=250-i()(this).val().length,o=V.render({flowerLimit:e});i()("#characterTracker").html(o)})),i()(document).on("click",".add-flowers",(function(){i()(this).hasClass("one-flower-per-day")?i()(".one-flower").show():(i()("#add-flower-note").val(""),i()("#characterTracker").html(V.render({flowerLimit:250})),i()("input[name=alertnate-signature]").val(""),i()("input:radio[name=show-name][value=Y]").prop("checked",!0),i().ajax({url:"/flowers/categories",success:function(e){if(e.result){e.contributorId=findagrave.contributorId,e.selectedCategory=findagrave.defaultBouquetGrouping?findagrave.defaultBouquetGrouping:"Flowers";var o=z.render(e);i()(".flower-category").html(o),Q(e.selectedCategory,findagrave.contributorId)}}}))})),i()(document).on("change","#flower-category-select",(function(){Q(i()(this).val().trim(),findagrave.contributorId)})),i()(document).on("click","#add-leave-flower",(function(){if(findagrave.contributorId){var e=i()("#chosen-flower .each-flower-image").attr("data-flower-id"),o=i()("input:radio[name=show-name]:checked").val(),t=i().trim(i()("input[name=alertnate-signature]").val()),a=!0;if("A"==o&&t.length<1&&(a=!1,alert("Please key in the alternate signature")),a)!function(e){i()("#add-leave-flower").attr("disabled","disabled"),i().ajax({method:"POST",url:"/memorial/flowers/add",data:e,success:function(o){i()("#add-leave-flower").prop("disabled",!1),"Success"===o.status?(Y(e.intermentId,e.contributorId,0,null,!1,(function(e){findagrave.flowersLimit=e.flowersLimit,findagrave.flowersSkip=e.flowersSkip})),i()("#leaveFlower").modal("hide")):"Failure"===o.status&&"CanOnlyAddOneADayPerMemorial"===o.message&&i()("#oneFlowerPerDay").removeClass("hidden")}})}({intermentId:findagrave.memorialId,boquetId:e,contributorId:findagrave.contributorId,publicnotetext:i()("#add-flower-note").val(),FLdisplayName:o,FLalternateSignature:t})}else alert("Warning!! User has to be logged in to add flowers")})),i()(document).on("click",".delete-flower",(function(){findagrave.flowerId=i()(this).attr("data-flower-id")})),i()("#cancelFlowerDelete").on("click",(function(){findagrave.flowerId="",i()("#confirmFlowerDelete").modal("hide")})),i()("#deleteFlower").on("click",(function(){!function(e){i().ajax({method:"POST",url:"/memorial/flowers/delete/"+e.flowerId,success:function(o){"Success"==o.status?(Y(e.intermentId,e.contributorId,0,null,!1,(function(e){findagrave.flowersLimit=e.flowersLimit,findagrave.flowersSkip=e.flowersSkip})),findagrave.flowerId="",i()("#confirmFlowerDelete").modal("hide")):(i()("#flowerFailedDelete").removeClass("hidden"),setTimeout((function(){i()("#flowerFailedDelete").addClass("hidden"),findagrave.flowerId="",i()("#confirmFlowerDelete").modal("hide")}),3e3))}})}({contributorId:findagrave.contributorId,intermentId:findagrave.memorialId,flowerId:findagrave.flowerId})})),i()("#deleteMemorial").on("click",(function(){i().ajax({method:"POST",url:"/memorial/delete-memorial/"+findagrave.memorialId+"/"+findagrave.memorialCemeteryId,success:function(e){if("Success"==e.status)window.location.reload();else{i()("#memorialFailedDelete").removeClass("hidden");setTimeout((function(){i()("#memorialFailedDelete").addClass("hidden")}),3e3)}}})})),i()(document).on("change","input[type=radio][name=filter-flowers]",(function(){"all_flowers"==this.value?(i()(".flower-board-item").show(),findagrave.divFlowers&&(i()(findagrave.divFlowers).appendTo(".flowers-board-list").each((function(){var e=i()(this).data("initial-index");i()(".board-item").eq(e).before(this)})),findagrave.divFlowers=null),findagrave.flowerCheckedOption="allFlowers",i()(".flower-board-item").length<8?i()(".flowers-board-list .floating-board").hide():i()(".flowers-board-list .floating-board").show()):"my_flowers"==this.value&&(findagrave.flowerCheckedOption="myFlowers",i()(".css--my-flower").length<8?i()(".flowers-board-list .floating-board").hide():i()(".flowers-board-list .floating-board").show(),findagrave.divFlowers=i()(".flowers-board-list .board-item").not(".css--my-flower, .floating-board").detach())})),i()(document).on("click","#fulfill",(function(e){e.stopPropagation(),e.preventDefault(),c()})),i()(document).on("click","#set-fulfill",(function(e){findagrave.fulfill=!0})),i()(document).on("click",".toggle-fulfill-alert",(function(){i()("#photoRequestPresent").addClass("hidden"),i()(".dragdrop-wrapper").removeClass("hidden")})),i()("#add-photos").on("show.bs.modal",(function(){var e=i()("#addPhotoSubmit"),o=i()("#CancelUpload"),t=i()("#doneAddPhoto"),a=i()(".dragdrop-wrapper"),r=i()("#number-of-images"),d=i()("#upload-error"),n=i()("#upload-success");e.removeClass("hidden"),o.removeClass("hidden"),t.addClass("hidden"),a.removeClass("hidden"),a.fadeIn(),null==S||S.removeAllFiles(),r.text(""),d.addClass("hidden"),n.addClass("hidden")})),i()(".js--openDropzone").on("click",(function(){i()("#dragImg").trigger("click")})),i()(document).on("click",".board-item---body",(function(e){e.stopPropagation()})),i()(document).on("shown.bs.modal","#photoViewer",(function(){"complete"===document.readyState?window.addEventListener("popstate",m,!1):i()(window).on("load",(function(){setTimeout((function(){window.addEventListener("popstate",m,!1)}),50)}))})),i()(document).on("hidden.bs.modal","#photoViewer",(function(){-1!==location.hash.indexOf("view-photo")&&history.back(),window.removeEventListener("popstate",m),N.destroy(),findagrave.isPhotoOverlayUpdated&&(i()("#TabPhotos").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),i()(".js--photoGrid").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),findagrave.photosSkip=0,findagrave.photosLimit=20,G(findagrave.memorialId,findagrave.memorialContributorId,findagrave.contributorId,findagrave.isFamous,findagrave.photosLimit,findagrave.photosSkip,!1,!1,(function(e){findagrave.photosLimit=e.photosLimit,findagrave.photosSkip=e.photosSkip,findagrave.isPhotoOverlayUpdated=!1})))})),i()(document).on("hidden.bs.modal","#add-photos",(function(e){findagrave.fulfill=!1,i()("#addTitle").removeClass("hidden"),i()("#fulfillTitle").addClass("hidden"),i()("#photoRequestFulfilled").addClass("hidden"),i()("#FinishedUpload").addClass("hidden")})),i()(document).on("show.bs.modal","#add-photos",(function(e){!findagrave.hasPhotoRequest||findagrave.fulfill||findagrave.claimedBy&&findagrave.claimedBy!=findagrave.contributorId||(i()("#photoRequestPresent").removeClass("hidden"),i()(".dragdrop-wrapper").addClass("hidden"))})),i()(document).on("click",".request-photos",(function(e){e.stopPropagation(),e.preventDefault(),i()(".add-photos").removeClass("added"),i()(".request-photos").addClass("added")})),i()(document).on("click",".add-photos",(function(e){e.stopPropagation(),e.preventDefault(),i()(".request-photos").removeClass("added"),i()(".add-photos").addClass("added")})),i()(document).on("click",".add-flowers",(function(e){e.stopPropagation(),e.preventDefault(),i()(".add-flowers").addClass("added")})),J(findagrave.memorialId,findagrave.memorialCemeteryId),i()("#newVirtualCemetery-btn").on("click",(function(){i()("#newVirtualCemetery-input").removeClass("hidden"),i()(this).hide()})),i()(".remove-circle").on("click",(function(){return i()(this).parents(".input-has-icon").find(".form-control").val(""),i()(this).parent().prev().hasClass("memorialInfo")&&i()(this).parents(".new-member").find(".form-control-static").html(""),!1})),i()("#closeAlert").on("click",(function(){i()("#duplicateId").addClass("hidden")})),i()("#js--add-more-btn").on("click",(function(){i()("#more-spouse").collapse("show"),i()(this).hide()})),i()(document).on("click",".flower-item",(function(){i()(this).find(".flower-text").toggleClass("hidden"),i()(this).find(".full-flower-text").toggleClass("hidden")})),i()(document).on("change","input[type=radio][name=filter-photos]",(function(){"all_photos"==this.value?(i()(".photos-board-item").show(),findagrave.photoSelectedTab="allPhotos",findagrave.divPhotos&&(i()(findagrave.divPhotos).appendTo(".photos-list").each((function(){var e=i()(this).data("initial-index");i()(".board-item").eq(e).before(this)})),findagrave.divPhotos=null),i()(".photos-board-item").length<8?i()(".photos-list .floating-board").hide():i()(".photos-list .floating-board").show()):"my_photos"==this.value&&(i()(".css--my-photo").length<8?i()(".photos-list .floating-board").hide():i()(".photos-list .floating-board").show(),findagrave.divPhotos=i()(".photos-list .board-item").not(".css--my-photo, .floating-board").detach(),findagrave.photoSelectedTab="myPhotos")})),i()(document).on("click",".deletePhoto",(function(){var e=i()(this).attr("data-id");i()("#deletePhoto").attr("data-overlay","false"),i()("#deletePhoto").attr("data-photoId",e),i()("#deletePhoto").modal("show")})),i()(document).on("click",".showDelete",(function(e){e.stopPropagation(),e.stopImmediatePropagation();var o=i()(this).attr("data-id");i()("#deletePhoto").attr("data-overlay","true"),i()("#deletePhoto").attr("data-photoId",o),i()("#deletePhoto").modal("show")})),i()(document).on("click","#deletePhotoConfirmed",(function(){var e=i()("#deletePhoto").attr("data-overlay");!function(e,o){"true"===o?i().ajax({method:"POST",url:"/memorial/delete-photo",data:{photoId:e,memorialId:findagrave.memorialId},success:function(o){if(200===o.status){S&&S.options.uploadCount--,findagrave.isPhotoOverlayUpdated=!0,i()(".photosCount").html((parseInt(i()(".photosCount").html())-1).toString()),i()(".profileImage").attr("data-imgphoto-id")==e&&i()(".profileImage").attr("src","../assets/images/img-grave.jpg");var t=i()(".photo-viewer-carousel"),a=i()(".viewer-item").index(i()(".viewCurrentImg-"+e));t.trigger("remove.owl.carousel",a),t.trigger("to.owl.carousel",a),0==t.find(".viewer-item").length&&i()("#photoViewer").modal("hide"),i()("#deletePhoto").modal("hide")}else i()("#deleteFailedCancel").removeClass("hidden")}}):(i()("#TabPhotos").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),i()(".js--photoGrid").html('<div class="loader-h" role="status"><span class="visually-hidden">Loading...</span><div class="disc disc-1"></div><div class="disc disc-2"></div><div class="disc disc-3"></div></div>'),findagrave.photosSkip=0,findagrave.photosLimit=20,i().ajax({method:"POST",url:"/memorial/delete-photo",data:{photoId:e,memorialId:findagrave.memorialId},success:function(o){200===o.status?(S&&S.options.uploadCount--,G(findagrave.memorialId,findagrave.memorialContributorId,findagrave.contributorId,findagrave.isFamous,findagrave.photosLimit,findagrave.photosSkip,!1,!1,(function(e){findagrave.photosLimit=e.photosLimit,findagrave.photosSkip=e.photosSkip})),i()(".profileImage").attr("data-imgphoto-id")==e&&i()(".profileImage").attr("src","../assets/images/img-grave.jpg"),i()(".profileImage").attr("data-imgphoto-id")==e&&i()(".profileImage").attr("src","../assets/images/img-grave.jpg"),i()("#deletePhoto").modal("hide")):i()("#deleteFailedCancel").removeClass("hidden")}}))}(i()("#deletePhoto").attr("data-photoId"),e)})),i()("#deletePhoto").on("hide.bs.modal",(function(){i()("#deletePhoto").removeAttr("data-overlay"),i()("#deletePhoto").removeAttr("data-photoId"),i()("#deleteFailedCancel").addClass("hidden")})),i()(document).on("click",".showrotatel",(function(){h(i()(this).attr("data-id"),-90)})),i()(document).on("click",".showrotater",(function(){h(i()(this).attr("data-id"),90)})),i()(document).on("click",".showSave, .showSaveButton",(function(e){e.stopPropagation(),e.stopImmediatePropagation();var o=i()(this).data("id");o||(o=i()(this).attr("name").split("-")[1]);var t=i()("textarea[name='publicNote-"+o+"']").val(),a=i()("input[type='radio'][name='photoType-"+o+"']:checked").val();!function(e,o,t,a){var r=i()(".showSave[data-id="+e+"]"),d=i()("input[type='radio'][name='photoType-"+e+"']:checked").closest("fieldset").find("span.typeSaved");r.button("loading"),r.attr("disabled","true"),r.addClass("disabled"),i().ajax({method:"POST",url:"/memorial/update-photo",data:{photoId:e,memorialId:o,publicNote:t,photoType:a},success:function(o){200==o.status?(i()("#confirmPhotoUpdated-"+e).removeClass("hidden"),i()("#confirmPhotoUpdated-"+e).attr("role","alert"),findagrave.isPhotoOverlayUpdated=!0,setTimeout((function(){r.text(findagrave.i18nSaved)}),3e3),d.removeClass("hidden"),setTimeout((function(){d.addClass("hidden")}),3e3)):(i()("#confirmPhotoFailed-"+e).removeClass("hidden"),i()("#confirmPhotoFailed-"+e).attr("role","alert"),setTimeout((function(){r.text(findagrave.i18nError)}),1e3)),setTimeout((function(){r.text(findagrave.i18nSave),i()("#confirmPhotoUpdated-"+e).addClass("hidden"),i()("#confirmPhotoFailed-"+e).addClass("hidden")}),3e3)}})}(o,findagrave.memorialId,t,a)})),i()(document).on("click","#savePhotoOrder",(function(){var e=[];i()("#photo-sort-list").children("li").each((function(){var o={photoId:i()(this).attr("data-photoId"),photoType:i()(this).attr("data-photoType")};e.push(o)})),e.length>1&&i().ajax({url:"/memorial/update-photo-sort-order",method:"POST",data:{memorialId:findagrave.memorialId,ajax:!0,sortOrder:JSON.stringify(e)},success:function(e){location.reload()}})})),(0,v.Z)(),i()(document).on("click",".reportFlowerButton",(function(){findagrave.reportFlower=i()(this).attr("data-id")})),i()("#reportFlowerAbuse").on("click",(function(){var e;(e=findagrave.reportFlower)&&i().ajax({url:"/memorial/report-flower",method:"POST",data:{flowerId:e},success:function(o){200===o.responseCode?(findagrave.reportFlower=null,i()("#flowerReportSuccess").removeClass("hidden"),i()(".flowerReported-"+e).closest(".flower-board-item").remove(),i()("#cancelFlowerDelete").addClass("hidden"),i()("#reportFlowerAbuse").addClass("hidden"),i()("#reportFlowerDone").removeClass("hidden")):(i()("#flowerReportFailed").removeClass("hidden"),i()("#cancelFlowerDelete").addClass("hidden"),i()("#reportFlowerAbuse").addClass("hidden"),i()("#reportFlowerDone").removeClass("hidden"))}})})),i()("#reportFlower").on("hide.bs.modal",(function(){i()("#flowerReportFailed").addClass("hidden"),i()("#flowerReportSuccess").addClass("hidden"),i()("#cancelFlowerDelete").removeClass("hidden"),i()("#reportFlowerAbuse").removeClass("hidden"),i()("#reportFlowerDone").addClass("hidden")})),i()(document).on("click",".addToScrapbook",(function(){!function(e){if(e){var o=!1;w.ajax({url:"/user/add-user-upload-flower",method:"POST",data:{bouquetTypeId:e},success:function(e){o=1002!==e.result.code||"NC",window.location.href="/user/manage-scrapbook?flowerAdded="+o}})}}(i()(this).data("id"))})),i()(document).on("click",".tutorials button",(function(){u(this)})),i()(document).on("click",".skip-tutorial",(function(){i()(".tutorials").addClass("hidden"),i()(".tutorials div.text-center").addClass("hidden"),i()(".panel-mem-1").removeClass("hidden")})),i()(document).on("click",".btn-tutorial",(function(){i()(".tutorials").removeClass("hidden")})),i()("#requestInfo").on("show.bs.collapse",(function(){i()("#expandMore").addClass("hidden")})),i()(document).on("click",".close-rd-banner",(function(){var e=(0,d.Ce)(),o=window.location.pathname.match(/\/memorial\/\d+\//);e.pref&&o&&o.length&&(0,d.d8)("hideRDBanner","true",365,o[0])})),i()(document).on("i18nLoaded",(function(){if(G(findagrave.memorialId,findagrave.memorialContributorId,findagrave.contributorId,findagrave.isFamous,findagrave.photosLimit,findagrave.photosSkip,!1,!0,(function(e){findagrave.photosLimit=e.photosLimit,findagrave.photosSkip=e.photosSkip})),Y(findagrave.memorialId,findagrave.contributorId,findagrave.flowersLimit,findagrave.flowersSkip,!1,(function(e){findagrave.flowersLimit=e.flowersLimit,findagrave.flowersSkip=e.flowersSkip})),window.location.hash){var e=window.location.hash.substring(1);if("add-photos"==e)history.replaceState("",document.title,window.location.pathname),c();else if("photo-request-from-email"==e)history.replaceState("",document.title,window.location.pathname),P("#photo-request-from-email");else if("suggested-merge"==e)history.replaceState("",document.title,window.location.pathname),P("#suggestedMerge"),setTimeout((function(){i()("#suggestedMerge").addClass("out")}),5e3);else if("requested-transfer"==e)history.replaceState("",document.title,window.location.pathname),P("#requestedTransfer"),setTimeout((function(){i()("#requestedTransfer").addClass("out")}),5e3);else if(/^updated/.test(e))if(history.replaceState("",document.title,window.location.pathname),P("#updateSuccessful"),/^updated-/.test(e)){var o=B.render({relationshipType:e.split("-")[1]});i()("#updateSuccessful").append(o)}else setTimeout((function(){i()("#updateSuccessful").addClass("out")}),5e3);else if("memorialSponsored"==e)history.replaceState("",document.title,window.location.pathname),P("#memorialSponsored"),setTimeout((function(){i()("#memorialSponsored").addClass("out")}),5e3);else if("suggestionSubmitted"==e)history.replaceState("",document.title,window.location.pathname),P("#suggestionSubmitted"),setTimeout((function(){i()("#suggestionSubmitted").addClass("out")}),5e3);else if(/^noChange/.test(e))if(history.replaceState("",document.title,window.location.pathname),P("#noChange"),/^noChange-/.test(e)){o=B.render({relationshipType:e.split("-")[1]});i()("#noChange").append(o)}else setTimeout((function(){i()("#noChange").addClass("out")}),5e3);else"start-tutorial"==e?(history.replaceState("",document.title,window.location.pathname),i()(".tutorials").removeClass("hidden")):"tutorial-memorial-photo"==e?(history.replaceState("",document.title,window.location.pathname),u(i()(".panel-mem-2").find("button.next"),!0)):"tutorial-photo"==e?(history.replaceState("",document.title,window.location.pathname),u(i()(".panel-mem-3").find("button.next"),!0)):"tutorial-flower"==e?(history.replaceState("",document.title,window.location.pathname),u(i()(".panel-mem-4").find("button.next"),!0)):"tutorial-memorial"==e?(history.replaceState("",document.title,window.location.pathname),u(i()(".panel-mem-5").find("button.next"),!0)):"photoRequestDeleted"==e?(P("#photoRequestDeleted"),history.replaceState("",document.title,window.location.pathname)):"photoRequestDeletedFailed"==e?(P("#photoRequestDeletedFailed"),history.replaceState("",document.title,window.location.pathname)):"memorial-transferred"==e&&(P("#memorialTransferredMessage"),history.replaceState("",document.title,window.location.pathname))}}))}))}}]);